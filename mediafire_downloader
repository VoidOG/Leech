import requests
from bs4 import BeautifulSoup
import os

def download_mediafire(link):
    try:
        # Send a GET request to the Mediafire link
        response = requests.get(link)
        response.raise_for_status()  # Raise an error for bad responses

        # Parse the page content
        soup = BeautifulSoup(response.text, 'html.parser')

        # Find the direct download link
        download_button = soup.find('a', {'id': 'downloadButton'})
        if download_button is None:
            return "Error: Unable to find the download link."

        download_url = download_button['href']

        # Define the download path
        download_path = "downloads"
        if not os.path.exists(download_path):
            os.makedirs(download_path)

        # Get the file name from the download URL
        file_name = download_url.split('/')[-1]
        file_path = os.path.join(download_path, file_name)

        # Download the file
        with requests.get(download_url, stream=True) as r:
            r.raise_for_status()  # Raise an error for bad responses
            with open(file_path, 'wb') as f:
                for chunk in r.iter_content(chunk_size=8192):
                    f.write(chunk)

        return file_path  # Return the path to the downloaded file
    except Exception as e:
        return f"Error downloading from Mediafire: {str(e)}"
